<script>
  const SHEET_API_URL = "https://script.google.com/macros/s/AKfycbwv_fCxZsShYT60ylwV57PSidy5s2w6pVsd-CiBkGy_ZmUjhcdL2sVfFcLgunxjVvox/exec";

  function fetchAndDisplayData() {
    fetch(SHEET_API_URL)
      .then(response => response.json())
      .then(data => {
        const tbody = document.querySelector("#stockTable tbody");
        tbody.innerHTML = "";

        data.forEach(row => {
          const tr = document.createElement("tr");

          const itemName = row["Item Name"] || "-";
          const category = row["Category"] || "-";
          const status = row["Status"] || "-";
          const stock = row["Stock"] || "-";
          const updated = row["Last Updated"] || "-";

          let statusClass = "";
          if (status === "In Stock") {
            statusClass = "in-stock";
          } else if (status === "Needs Reorder") {
            statusClass = "needs-reorder";
          } else {
            statusClass = "out-of-stock";
          }

          tr.innerHTML = `
            <td>${itemName}</td>
            <td>${category}</td>
            <td><span class="badge ${statusClass}">${status}</span></td>
            <td>${stock}</td>
            <td>${updated}</td>
          `;
          tbody.appendChild(tr);
        });
      })
      .catch(error => console.error("Failed to load data:", error));
  }

  window.onload = fetchAndDisplayData;
</script>
